version: '3.8'

services:
  web-portal:
    build:
      context: ./web-portal
      dockerfile: Dockerfile
    ports:
      - "8080:80"
    environment:
      - VITE_MCP_SERVER_URL=http://localhost:3000/mcp
      # In Docker network, use service name. But client-side JS runs in browser, so localhost is correct for user access.
      # If accessing from another container, use http://mcp-bridge:3001/api/tools/...
      - VITE_AGENT_URL=https://agent-api.scarmonit.workers.dev
    networks:
      - scarmonit-net

  mcp-bridge:
    build:
      context: .
      dockerfile: mcp-bridge/Dockerfile
    ports:
      - "3000:3001" # Map host 3000 (standard MCP bridge port) to container 3001
    networks:
      - scarmonit-net

networks:
  scarmonit-net:
    driver: bridge